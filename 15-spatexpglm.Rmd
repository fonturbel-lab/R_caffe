---
title: "15 - Spatially-explicit Generalized Linear/Additive Models"
author: "Francisco E. Fonturbel"
date: "15/November/2022"
output: 
  html_document:
    includes:
        after_body: footer.html
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = TRUE,
	message = FALSE,
	warning = FALSE
)
```

# Including the spatial structure in our models

Organisms in nature are rarely distributed in regular arrangements. We usually found plants or animals forming clusters in high-quality microhabitats or randomly distributed in some areas. Such arrangement pattern is called _spatial structure_ and it is from remarkable importance in ecology. When we collect field data, we may obtain geographic coordinates from our sampling sites / units and therefore conduct sptially-explicit models, including the relative location of each unit as a covariate.

To illustrate this lesson, we will use (again) the data of [Font√∫rbek et al. 2015](https://besjournals.onlinelibrary.wiley.com/doi/full/10.1111/1365-2745.12443).

```{r data}
library(spdep)
library(spatstat)
library(mgcv)
library(nortest)
library(gstat)
library(ncf)
library(mpmcorrelogram)
library(ggplot2)

data<-read.csv("data/11_mistletoe_data.csv", 
                     header=TRUE, 
                     sep=";",
                     dec=".",
                     na.strings="NA")
attach(data)
head(data)

x<-data$UTM_E
y<-data$UTM_N

##Some ggplot2 grooming
My_Theme = theme(
  axis.title.x = element_text(size = 20,face="bold"),
  axis.text.x = element_text(size = 16),
  axis.text.y = element_text(size = 16),
  axis.title.y = element_text(size = 20,face="bold"),
  legend.text = element_text(size = 14),
  legend.title = element_text(size = 14,face="bold"),
  panel.grid.major = element_blank(),
  panel.grid.minor = element_blank(),
  panel.background = element_rect(fill = "white"))
```


## The spatial covariate approach

The simplest approach to conduct a spatially-explicit model is to 

```{r model1}

```




## Final thoughts

GLMM models allow us to include random effects in our GLM models (using all the possible distributions that we learned in the past sessions) to account for covariates, variation sources, and repeated measures. This applies for GAM models as well.


## Session

```{r session, echo=TRUE}
sessionInfo()
```
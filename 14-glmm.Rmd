---
title: "14 - Generalized Mixed-Effects Linear Models"
author: "Francisco E. Fonturbel"
date: "8/November/2022"
output: 
  html_document:
    includes:
        after_body: footer.html
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = TRUE,
	message = FALSE,
	warning = FALSE
)
```

# Models with fixed and random effects

So far, we have operated fixed effects in our Generalized models. A fixed effect is a fully controled and known variable, but in nature we have many variation sources that we cannot control or from which we cannot evaluate all levels. Thus variation sources are known as **random effects** and we can include them into the models to take them into account, but not as predictors but as covariates.

To illustrate this lesson, we will use (again) the data of [Cordero et al. 2020](https://www.mdpi.com/2071-1050/12/21/9252).

```{r data}
library(mgcv)
library(lme4)
library(MASS)
library(lmerTest)
library(pbkrtest)
library(MuMIn)
library(corrplot)
library(ggpubr)
library(PairedData)
library(plyr)
library(ggplot2)
library(GGally)
source("multiplot.R")

data<-read.table("data/10_data_threat.txt", 
                     header=TRUE, 
                     sep="\t",
                     dec=",",
                     na.strings="NA")
attach(data)

##Some ggplot2 grooming
My_Theme = theme(
  axis.title.x = element_text(size = 20,face="bold"),
  axis.text.x = element_text(size = 16),
  axis.text.y = element_text(size = 16),
  axis.title.y = element_text(size = 20,face="bold"),
  legend.text = element_text(size = 14),
  legend.title = element_text(size = 14,face="bold"),
  panel.grid.major = element_blank(),
  panel.grid.minor = element_blank(),
  panel.background = element_rect(fill = "white"))
```

aaaaa

## Final thoughts

GLMM models allow us to include random effects in our models to account for covariates, variation sources, and repeated measures. This applies for GAM models as well.


## Session

```{r session, echo=TRUE}
sessionInfo()
```
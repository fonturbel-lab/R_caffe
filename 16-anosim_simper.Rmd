---
title: "16 - ANOSIM and SIMPER"
author: "Francisco E. Fonturbel"
date: "23/November/2022"
output: 
  html_document:
    includes:
        after_body: footer.html
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = TRUE,
	message = FALSE,
	warning = FALSE
)
```

## How to analyze species composition?

Dealing with biodiversity data is somewhat different than dealing with the usual stuff that we are used to. Some authors use standard approaches (e.g., ANOVA) to compare species composition among sites, but this is not correct as in this case the identity of the species matters, and traditional methods cannot consider them.

```{r data}
library(vegan)

data<-read.table("data/16_bird_data.txt", 
                     header=TRUE, 
                     sep="\t", dec=".", 
                     na.strings="NA")
attach(data)
head(data)
```

We will use the data of [Fontúrbel et al. 2020](https://www.sciencedirect.com/science/article/pii/S1470160X20308013) to illustrate this. This dataset contains bird abundance data for camera trap and point count data, comparing four habitat conditions.

## Analysis of Similarities (ANOSIM)

When we have species presence/absence or relative abundance data with two or more groups and at least three replicates per group, we can use the Analysis of Similarities (ANOSIM) to test for spècies composition differences. ANOSIM is a non-parametric approach that uses a similarity metric (e.g., Jaccard or Bray-Curtis) to compare species similarity within and between groups (following the same logic than ANOVA). The resulting statistics (R) is not a proportional value as it is calculated upon rankings (and it should not be interpreted as a linear scale of difference). The significance of this test is estimated using permutations (P value is the number of times that the randomized R value is equal or greater than the real R value, divided by the number of permutations).

```{r anosim1}
#Extract the columns with species data in a separate object
birds<-data[,3:22]

#Creating a distance matrix
birdist<-vegdist(birds)

#ANOSIM per habitat
forestbirds<-anosim(birdist, data$Habitat, permutations = 999, distance = "bray")
summary(forestbirds)
plot(forestbirds, xlab="Condition", ylab="Rank distance")
```


So, there is no difference among habitat conditions. What about sampling approaches?

```{r anosim2}
sampbirds<-anosim(birdist, data$Sample, permutations = 999, distance = "bray")
summary(sampbirds)
plot(sampbirds, xlab="Sampling method", ylab="Rank distance")
```

In this case, we found a significant difference, in which point counts are different from camera traps.

## Final thoughts

Linear regression and correlation are our entryway to understand linear relationships among linear variables. Linear regression allows us to assess the causal relationship between two continuous variables, whereas correlation examines association between a pair of variables without implying a causal relationship.


## Session

```{r session, echo=TRUE}
sessionInfo()
```
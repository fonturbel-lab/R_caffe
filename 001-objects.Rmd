---
title: "Managing and operating objects in R"
author: "Francisco E. Fonturbel"
date: "11/May/2022"
output: 
  html_document:
    includes:
        after_body: footer.html
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = TRUE,
	message = FALSE,
	warning = FALSE
)
```

## Handling data in R

R is an open source platform that can be used to perform statistical analyses and many other things (genetics, maps, etc.). So, R is an object-based programming language, which means that it is based on creating, manipulating, and operating objects.

R objects are case sensitive, for example, "vector" and "Vector" are considered as different objects. Thus, if you are getting a recurrent error trying to call or operate an object, the first thing to do is check your spelling. Be sure that you are calling your object exactly as it was created (hint: the Environment tab on R Studio, located at the upper right corner, contains a list of all objects and functions currently loaded in R).

## Datasets

The primordial input in science is data. Regardless of our study field, we all use data (collected after hard fieldwork or long lab hours) and the quality of our analyses and papers depend on the quality of our data. Likewise, properly managing our data is crucial to have a smooth experience in R. So, my first advice will be: "please, **AVOID** the `openxlsx` library; it might seem to make your life easier but most of the time it will make your experience with R very hard.

Tips for loading your data without problem:

(1) Prefer csv (comma-separated text) or txt (tab-separated text) formats to input your data in R.

(2) Avoid spaces, points, and commas in variable names.

(3) Do not leave empty cells.

```{r loading data}
#Let's load the data file
#We will create an object called "data" with this information
data<-read.table("data/cactus.txt", header = T)
attach(data)
```

Let's see if we can see the data file by calling the object:

```{r call}
data
```

OK, it seems to be in order! Now we have to concatenate the three columns into one:

```{r conc}
#Concatenate the data rows of df1 into a single vector r
r<-c(t(as.matrix(data)))
#Assign new variables for the treatment levels and number of observations
f = c("Pop1", "Pop2", "Pop3") #Population names
k = 3 #Number of populations sampled
n = 15 #Number of samples per population
#Create a vector of treatment factors that corresponds to each element of r
tm <- gl(k, 1, n*k, factor(f))
```

In a next step, we need to define the blocks:

```{r blocks}
blk = gl(n, k, k*n)             # blocking factor
```


Now we have our data properly ordered. Let's fit a one-way ANOVA model with this:

```{r ANOVA}
aov.cactus <- aov(r ~ tm + blk)
```

OK, now we have an object called `aov.cactus`, now we'll use the `summary()` function to see the results:

```{r result_aov}
summary(aov.cactus)
```

Our results indicate that cactus height is **significantly different** among the three sampled population. However, the block factor `blk` is not significant, indicating that the influence of environmental heterogeneity within populations is negligible.

## Session

```{r session, echo=TRUE}
sessionInfo()
```
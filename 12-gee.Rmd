---
title: "12 - Generalized Estimation Equations and special distributions"
author: "Francisco E. Fonturbel"
date: "14/September/2022"
output: 
  html_document:
    includes:
        after_body: footer.html
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = TRUE,
	message = FALSE,
	warning = FALSE
)
```

# Relaxing model assumptions even further

Generalized Linear Models relax some assumptions (e.g., a normal distribution) and allow us to use count data or presence/absence data instead. In this opportunity, we will go beyond and relax other assumptions to properly analyze real life data.

In this opportunity, we will (1) compare regular GLMs with their zero-inflated alter-egos, and (2) use Generalized Estimation Equations (GEE) that are a variation of GLMs relaxing the assumption of variance homogeneity.


## Zero-inflated distributions

These are an special version of Poisson and negative binomial distributions in which we have an excess of zeroes creating a deviation towards zero in the observed distribution. In many biological systems we face this problem, as capture / record events are rare. For example, when we set traps for capturing a given animal, in most cases the trapping success is lower than 20%. Thus, we will have a lot of zeroes in our data, and therefore the conclusions from our GLM models may not be entirely reliable.

In the past session we introduced different data distributions, but now we'll see zero-inflated models in action. To illustrate this session, we will use data from [Font√∫rbel et al. (2015)](https://besjournals.onlinelibrary.wiley.com/doi/abs/10.1111/1365-2745.12443), which is the same we used on the past session. Remeber that our response variables are camera trap records from two species:  _Dromiciops gliroides_ and _Sephanoides sephaniodes_, in which we have a lot of zeroes.

```{r data}
library(MASS)
library(lme4)
library(geepack)
library(pscl)

data<-read.csv("data/11_mistletoe_data.csv", 
                     header=TRUE, 
                     sep=";",
                     dec=".",
                     na.strings="NA")
attach(data)
head(data)
```

Let's try a Poisson GLM for _D. gliroides_ visits:

```{r poisson_dg}
model1<-glm(dg_visits ~ temp_std + hum_std + lum_std + s250clasif, family = poisson, data=data)
summary(model1)
```

Now, we will repeat the same GLM but using a zero-inflated poisson distribution instead:

```{r zero_dg}
model1zi<-zeroinfl(dg_visits ~ temp_std + hum_std + lum_std + s250clasif, data=data, dist = "poisson")
summary(model1zi)
```

And now, let's try a negative binomial GLM for _S. sephaniodes_ visits:

```{r nb_ss}
model2<-glm.nb(ss_visits ~ temp_std + hum_std + lum_std + s250clasif, data=data)
summary(model2)
```

Now, we will repeat the same GLM but using a zero-inflated ndegative binomial distribution instead:

```{r zero_dg}
model2zi<-zeroinfl(ss_visits ~ temp_std + hum_std + lum_std + s250clasif, data=data, dist = "negbin")
summary(model2zi)
```

Despite there are no significant terms, the estimates change when we use zero-inflated distributions instead.


## Generalized Estimation Equations

xxx


## Final thoughts

Generalized Linear Models are the "parent" of ANOVAs, ANCOVAs, linear regressions, and other models. These kind of models have many advantages, such as using different probability distributions and using continuous and categorical predictors together. In the next four sessions we will explore the versatility and statistical power of these models and their application in our daily tasks in ecology.


## Session

```{r session, echo=TRUE}
sessionInfo()
```
---
title: "12 - Generalized Estimation Equations and special distributions"
author: "Francisco E. Fonturbel"
date: "14/September/2022"
output: 
  html_document:
    includes:
        after_body: footer.html
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = TRUE,
	message = FALSE,
	warning = FALSE
)
```

## Relaxing model assumptions even further




## Zero-inflated distributions

These are an special version of Poisson and negative binomial distributions in which we have an excess of zeroes creating a deviation towards zero in the observed distribution. In many biological systems we face this problem, as capture / record events are rare. For example, when we set traps for capturing a given animal, in most cases the trapping success is lower than 20%. Thus, we will have a lot of zeroes in our data, and therefore the conclusions from our GLM models may not be entirely reliable.

In the past session we introduced different data distributions, but now we'll see zero-inflated models in action.


## Generalized Linear Models in action

During my PhD, I've used camera traps to assesss the visitation rates of _Dromiciops gliroides_ and _Sephanoides sephaniodes_ to several mistletoe plants. Our response variables were, of course, count variables that should not be analyzed using a Gaussian distribution. In this case we measured some continuous variables in two environments (native forest and Eucalyptus plantation, a categorical variable). So, how can we perform a proper analysis for this?

To illustrate this point, we will use data from [Font√∫rbel et al. (2015)](https://besjournals.onlinelibrary.wiley.com/doi/abs/10.1111/1365-2745.12443)

```{r data}
library(MASS)
library(lme4)
library(AER)

data<-read.csv("data/11_mistletoe_data.csv", 
                     header=TRUE, 
                     sep=";",
                     dec=".",
                     na.strings="NA")
attach(data)
head(data)
```


So, our response variables are the columns _dg_visits_ and _ss_visits_ in the dataset that we just loaded. How they look like? let's make simple histograms:

```{r hist}
hist(dg_visits, main = "Dromiciops gliroides visits", col = "dodgerblue2", xlab = "Visits")
hist(ss_visits, main = "Sephanoides sephaniodes visits", col = "chocolate2", xlab = "Visits")
```

Clearly this analysis deserves a count distribution. Our first option may be a Poisson distribution, let's give it a try:

```{r poisson_mod}
model1<-glm(dg_visits ~ temp_std + hum_std + lum_std + s250clasif, family = poisson, data=data)
summary(model1)

model2<-glm(ss_visits ~ temp_std + hum_std + lum_std + s250clasif, family = poisson, data=data)
summary(model2)
```

Great! we have interesting results, but we need to test for overdispersion first. We will use the `dispersiontest` function from the `AER` library.

```{r overdisp}
dispersiontest(model1)
dispersiontest(model2)
```

Doh! we have data overdispersion in both cases. We should use a negative binomial distribution instead:

```{r nb_mod}
model1nb<-glm.nb(dg_visits ~ temp_std + hum_std + lum_std + s250clasif, data=data)
summary(model1nb)

model2nb<-glm.nb(ss_visits ~ temp_std + hum_std + lum_std + s250clasif, data=data)
summary(model2nb)
```

We obtained different results after changing the distribution from Poisson to Negative binomial. So, it is important to use the adequate distribution to obtain reliable results.


## Final thoughts

Generalized Linear Models are the "parent" of ANOVAs, ANCOVAs, linear regressions, and other models. These kind of models have many advantages, such as using different probability distributions and using continuous and categorical predictors together. In the next four sessions we will explore the versatility and statistical power of these models and their application in our daily tasks in ecology.


## Session

```{r session, echo=TRUE}
sessionInfo()
```
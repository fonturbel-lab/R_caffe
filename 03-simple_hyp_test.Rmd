---
title: "03 - Simple hypothesis test in R"
author: "Francisco E. Fonturbel"
date: "01/June/2022"
output: 
  html_document:
    includes:
        after_body: footer.html
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = TRUE,
	message = FALSE,
	warning = FALSE
)
```

## Simple hypothesis test in R

Now that we have the basic principles of creating and operating objects in R, as well as making some pretty nice graphics, now let's get started with statistics in R. Now we will start with some basic hypothesis testing by comparing the means of two or more treatments (groups).

Let's imagine that we measured the growth of some plants with two treatments: watered with 100 mL per day and watered with 50 mL per day. If there is no effect of the amount of water received, we should expect (i.e., null hypothesis) that the mean height of the plants will be equal:

$\mu {1} = \mu {2}$ 

And, of course, our alternative hypothesis would be:

$\mu {1} \neq \mu {2}$

As we have only two groups, we can use Student's _t test_ using the `t.test` function included in the R base package.

```{r packages}
data<-read.csv("data/03_waterpl.csv", header = TRUE, sep = ";")
attach(data)
```

So, we have a simple dataset containing plant height measurements for two treatments (named A and B).

```{r ttest}
t.test(height~treatment)
```

So, it seems that plant height differs, let's take a look using a simple boxplot:

```{r bp1}
boxplot(height~treatment, col = "darkorange1")
```

Also, _t tests_ depend on two main assumptions: normality and variance homogeneity. To examine normality we will use the Shapiro-Wilk test and to examine variance homogeneity we will use the Bartlett test.

```{r norm}
shapiro.test(height)
hist(height, col = "dodgerblue2")
```

OK, our data is normal but has some deviations from the "ideal" normal curve. Let's examine a Q-Q (quantile-quantile) plot to confirm this:

```{r qq}
qqnorm(data$height, pch = 1, frame = FALSE)
qqline(data$height, col = "firebrick", lwd = 3)
```

An ideal normal distribution will follow the red line.

## Final thoughts

a

## Session

```{r session, echo=TRUE}
sessionInfo()
```